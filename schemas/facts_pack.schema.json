{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Facts Pack",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_version",
    "as_of_utc",
    "universe",
    "timeframe",
    "market_data",
    "computed",
    "provenance"
  ],
  "properties": {
    "schema_version": {"type": "string", "const": "1.0"},
    "as_of_utc": {"type": "string", "format": "date-time"},
    "universe": {
      "type": "object",
      "additionalProperties": false,
      "required": ["venue", "symbols"],
      "properties": {
        "venue": {"type": "string"},
        "symbols": {
          "type": "array",
          "items": {"type": "string"},
          "minItems": 1,
          "uniqueItems": true
        }
      }
    },
    "timeframe": {
      "type": "object",
      "additionalProperties": false,
      "required": ["candle", "lookback_days"],
      "properties": {
        "candle": {"type": "string", "enum": ["1d"]},
        "lookback_days": {"type": "integer", "minimum": 7, "maximum": 3650}
      }
    },
    "market_data": {
      "type": "object",
      "additionalProperties": false,
      "required": ["candles"],
      "properties": {
        "candles": {
          "type": "object",
          "propertyNames": {"type": "string"},
          "additionalProperties": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": false,
              "required": ["t", "o", "h", "l", "c", "v"],
              "properties": {
                "t": {"type": "string", "format": "date-time"},
                "o": {"type": "number"},
                "h": {"type": "number"},
                "l": {"type": "number"},
                "c": {"type": "number"},
                "v": {"type": "number", "minimum": 0}
              }
            }
          }
        }
      }
    },
    "computed": {
      "type": "object",
      "additionalProperties": false,
      "required": ["realised_vol_annualised", "correlation"],
      "properties": {
        "realised_vol_annualised": {
          "type": "object",
          "propertyNames": {"type": "string"},
          "additionalProperties": {"type": "number", "minimum": 0}
        },
        "correlation": {
          "type": "object",
          "additionalProperties": false,
          "required": ["symbols", "matrix"],
          "properties": {
            "symbols": {
              "type": "array",
              "items": {"type": "string"},
              "minItems": 1,
              "uniqueItems": true
            },
            "matrix": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "array",
                "minItems": 1,
                "items": {"type": "number"}
              }
            }
          }
        }
      }
    },
    "provenance": {
      "type": "object",
      "additionalProperties": false,
      "required": ["sources"],
      "properties": {
        "sources": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "required": ["name", "type", "retrieved_at_utc"],
            "additionalProperties": false,
            "properties": {
              "name": {"type": "string"},
              "type": {"type": "string"},
              "retrieved_at_utc": {"type": "string", "format": "date-time"},
              "note": {"type": "string"}
            }
          }
        }
      }
    },
    "warnings": {
      "type": "array",
      "items": {"type": "string"}
    }
  }
}
